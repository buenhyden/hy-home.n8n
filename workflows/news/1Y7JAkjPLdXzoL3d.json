{
  "active": true,
  "connections": {
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          },
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          },
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        []
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-03T04:10:29.815Z",
  "id": "1Y7JAkjPLdXzoL3d",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "News Crawling",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -352,
        -144
      ],
      "id": "5fe6fb8d-4f92-466b-9cf5-5494007fdaf1",
      "name": "When clicking â€˜Execute workflowâ€™",
      "disabled": true
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C0A16RTTMGA",
          "mode": "list",
          "cachedResultName": "n8n"
        },
        "messageType": "block",
        "blocksUi": "={{ $json.slackBlocksJson }}",
        "text": "={{ $json.slackText }}",
        "otherOptions": {
          "mrkdwn": false
        }
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        704,
        0
      ],
      "id": "a4baac72-b808-4fd6-97f0-493d864ae3fa",
      "name": "Send a message",
      "webhookId": "feb9e5b1-1130-4000-8c83-d41ab0abfc1e",
      "alwaysOutputData": false,
      "credentials": {
        "slackApi": {
          "id": "19HmNrOnOqP2Fvue",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 * * * *"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -352,
        112
      ],
      "id": "4f144537-17d2-43be-ba80-dd400276a9a6",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "url": "https://openapi.naver.com/v1/search/news.json",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "query",
              "value": "IT"
            },
            {
              "name": "display",
              "value": "5"
            },
            {
              "name": "start",
              "value": "1"
            },
            {
              "name": "sort",
              "value": "sim"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Naver-Client-Id",
              "value": "qR7ty7ZP6XMG1eZHf7Xo"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        16,
        -144
      ],
      "id": "c897d317-c57d-4fd2-8e95-ed27509ac4e0",
      "name": "HTTP Request",
      "credentials": {
        "httpHeaderAuth": {
          "id": "9eaUgMH4xE4sfnrN",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. ëª¨ë“  ì…ë ¥ ë°ì´í„°ì—ì„œ ë‰´ìŠ¤ í•­ëª© ìˆ˜ì§‘ (Aggregation)\nlet allNews = $json.combinedResult;\n\n\n// 2. ë©”ì‹œì§€ ë¸”ë¡ ì´ˆê¸°í™” (Slack Block Kit)\nlet slackBlocks = [\n  {\n    \"type\": \"header\",\n    \"text\": {\n      \"type\": \"plain_text\",\n      \"text\": \"ğŸ“¢ IT & ìŠ¤íƒ€íŠ¸ì—… ë‰´ìŠ¤ ê²€ìƒ‰ 10\",\n      \"emoji\": true\n    }\n  },\n  {\n    \"type\": \"divider\"\n  }\n];\n\n// 3. ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬\nif (allNews.length === 0) {\n  const noDataMsg = \"ê²€ìƒ‰ëœ ë‰´ìŠ¤ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.\";\n  slackBlocks.push({\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": noDataMsg\n    }\n  });\n\n  // { blocks: [...] } êµ¬ì¡°ë¡œ ë˜í•‘\n  const finalPayload = { blocks: slackBlocks };\n\n  return [{\n    json: { \n      slackText: noDataMsg,\n      slackBlocks: finalPayload,\n      slackBlocksJson: JSON.stringify(finalPayload)\n    }\n  }];\n}\n\n// 4. ìƒìœ„ 10ê°œ í•­ëª©ë§Œ ì¶”ì¶œ (ìš”ì²­ì‚¬í•­ ë°˜ì˜)\nconst topNews = allNews.slice(0, 10);\n\n// 5. ê° ë‰´ìŠ¤ í•­ëª©ì„ ìˆœíšŒí•˜ë©° ìŠ¬ë™ ë¸”ë¡ êµ¬ì„±\nfor (const [index, news] of topNews.entries()) {\n  \n  // (1) ë°ì´í„° ì •ì œ (HTML íƒœê·¸ ì œê±° ë° ë””ì½”ë”©)\n  let titleStr = news.title || \"ì œëª© ì—†ìŒ\";\n  let descStr = news.description || \"ë‚´ìš© ì—†ìŒ\";\n\n  let cleanTitle = titleStr.replace(/<[^>]*>?/gm, '');\n  let cleanDesc = descStr.replace(/<[^>]*>?/gm, '');\n\n  const decodeEntities = (str) => {\n    return str\n      .replace(/&quot;/g, '\"')\n      .replace(/&amp;/g, '&')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&#39;/g, \"'\");\n  };\n\n  cleanTitle = decodeEntities(cleanTitle);\n  cleanDesc = decodeEntities(cleanDesc);\n\n  // (2) ë‚ ì§œ í¬ë§·íŒ…\n  let pubDateStr = \"\";\n  try {\n    if (news.pubDate) {\n        const pubDate = new Date(news.pubDate);\n        pubDateStr = pubDate.toLocaleDateString('ko-KR', { \n        year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' \n        });\n    } else {\n        pubDateStr = \"ë‚ ì§œ ì •ë³´ ì—†ìŒ\";\n    }\n  } catch (e) {\n    pubDateStr = news.pubDate;\n  }\n\n  // ë§í¬ ì£¼ì†Œ\n  const linkUrl = news.originallink || news.link || \"https://naver.com\";\n\n  // (3) ìŠ¬ë™ ë¸”ë¡ ì¶”ê°€ (ë²„íŠ¼ì„ ê¸°ì‚¬ ì˜†ìœ¼ë¡œ ì´ë™)\n  slackBlocks.push({\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": `*${index + 1}. ${cleanTitle}*\\nğŸ—“ ${pubDateStr}\\n${cleanDesc}`\n    },\n    \"accessory\": {\n      \"type\": \"button\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"ê¸°ì‚¬ ë³´ê¸°\",\n        \"emoji\": true\n      },\n      \"value\": `click_news_${index + 1}`,\n      \"url\": linkUrl,\n      \"action_id\": `button-action-${index}`\n    }\n  });\n\n  // êµ¬ë¶„ì„  (í–‰ êµ¬ë¶„ ì—­í• )\n  slackBlocks.push({ \"type\": \"divider\" });\n}\n\n// 6. ê²°ê³¼ ë°˜í™˜\n// ìš”ì²­í•˜ì‹  { blocks: [...] } í˜•íƒœì˜ ê°ì²´ êµ¬ì¡° ìƒì„±\nconst finalPayload = { blocks: slackBlocks };\n\nreturn [{\n  json: {\n    // í…ìŠ¤íŠ¸ ì•Œë¦¼ìš©\n    slackText: \"ğŸ“¢ IT & ìŠ¤íƒ€íŠ¸ì—… ë‰´ìŠ¤ ê²€ìƒ‰ 10\",\n    // 1. ê°ì²´ í˜•íƒœ (n8n ì„¤ì •ì— ë”°ë¼ ì‚¬ìš©)\n    slackBlocks: finalPayload,\n    // 2. JSON ë¬¸ìì—´ í˜•íƒœ (HTTP Request ë“±ìœ¼ë¡œ ë³´ë‚¼ ë•Œ ìœ ìš©)\n    slackBlocksJson: JSON.stringify(finalPayload)\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        0
      ],
      "id": "556c4d09-172f-4dd1-8919-b0e5ffdf284f",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "url": "https://openapi.naver.com/v1/search/news.json",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "query",
              "value": "ìŠ¤íƒ€íŠ¸ì—…"
            },
            {
              "name": "display",
              "value": "5"
            },
            {
              "name": "start",
              "value": "1"
            },
            {
              "name": "sort",
              "value": "sim"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Naver-Client-Id",
              "value": "qR7ty7ZP6XMG1eZHf7Xo"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        16,
        112
      ],
      "id": "5bc7435d-5c76-4559-bc75-680678e620ca",
      "name": "HTTP Request1",
      "credentials": {
        "httpHeaderAuth": {
          "id": "9eaUgMH4xE4sfnrN",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë…¸ë“œë“¤ì˜ ì´ë¦„ì„ ë°°ì—´ë¡œ ì ìœ¼ì„¸ìš”.\n// (ì‹¤ì œ n8n ìº”ë²„ìŠ¤ì— ìˆëŠ” ë…¸ë“œ ì´ë¦„ê³¼ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤)\nconst nodeNames = ['HTTP Request', 'HTTP Request1'];\n\n// 2. í•©ì¹˜ê³  ì‹¶ì€ JSONì˜ í‚¤(Key) ì´ë¦„ì„ ì ìœ¼ì„¸ìš”.\nconst targetKey = 'items';\n\n// í†µí•©ëœ ë°°ì—´ì„ ë‹´ì„ ë³€ìˆ˜\nlet mergedArray = [];\n\n// 3. ê° ë…¸ë“œë¥¼ ìˆœíšŒí•˜ë©° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.\nfor (const nodeName of nodeNames) {\n  // í•´ë‹¹ ë…¸ë“œì˜ ëª¨ë“  ì•„ì´í…œì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n  // ë…¸ë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ë°ì´í„°ê°€ ì—†ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ try-catch ë˜ëŠ” ì˜µì…”ë„ ì²´ì´ë‹ì„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n  let items = [];\n  try {\n    items = $(nodeName).all();\n  } catch (error) {\n    // í•´ë‹¹ ë…¸ë“œê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë¬´ì‹œí•˜ê³  ë„˜ì–´ê°‘ë‹ˆë‹¤.\n    continue;\n  }\n\n  for (const item of items) {\n    // í•´ë‹¹ í‚¤ì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.\n    const value = item.json[targetKey];\n\n    // ê°’ì´ ë°°ì—´ì¸ ê²½ìš°ì—ë§Œ í•©ì¹©ë‹ˆë‹¤.\n    if (Array.isArray(value)) {\n      mergedArray = mergedArray.concat(value);\n    } \n    // ë§Œì•½ ë°°ì—´ì´ ì•„ë‹ˆë¼ ë‹¨ì¼ ê°’ì´ë¼ë©´ ë°°ì—´ë¡œ ë§Œë“¤ì–´ ë„£ìŠµë‹ˆë‹¤. (ìœ ì—°ì„± í™•ë³´)\n    else if (value !== undefined && value !== null) {\n      mergedArray.push(value);\n    }\n  }\n}\n\n// 4. (ì„ íƒì‚¬í•­) ì¤‘ë³µ ì œê±° (Deduplication)\n// \"Banana\"ê°€ ë‘ ë²ˆ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë§‰ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ì¤„ì„ ì‚¬ìš©í•˜ì„¸ìš”.\nmergedArray = [...new Set(mergedArray)];\n\n// 5. (ì„ íƒì‚¬í•­) í‰íƒ„í™” (Flatten)\n// ë§Œì•½ [[\"A\"], [\"B\"]] ì²˜ëŸ¼ ì¤‘ì²©ëœ ë°°ì—´ì´ ë“¤ì–´ì˜¨ë‹¤ë©´ í•œ ì¤„ë¡œ í…ë‹ˆë‹¤.\nmergedArray = mergedArray.flat();\n\n// 6. ìµœì¢… ê²°ê³¼ ë°˜í™˜\nreturn [\n  {\n    json: {\n      sourceNodes: nodeNames, // ì°¸ê³ ìš©\n      targetKey: targetKey,   // ì°¸ê³ ìš©\n      // ì—¬ê¸°ê°€ ì§„ì§œ í•©ì³ì§„ ë°ì´í„°ì…ë‹ˆë‹¤.\n      combinedResult: mergedArray,\n      // ê°œìˆ˜ë„ ê°™ì´ ì•Œê³  ì‹¶ë‹¤ë©´\n      totalCount: mergedArray.length\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        0
      ],
      "id": "e041bc7c-e9a8-4584-b161-f393452ba02e",
      "name": "Code in JavaScript1",
      "executeOnce": true
    },
    {
      "parameters": {
        "mode": "chooseBranch"
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        192,
        0
      ],
      "id": "5c84cdee-8efd-4770-8396-2808c444b4a5",
      "name": "Merge"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-12-03T04:10:29.815Z",
      "createdAt": "2025-12-03T04:10:29.815Z",
      "role": "workflow:owner",
      "workflowId": "1Y7JAkjPLdXzoL3d",
      "projectId": "fXIt88XxLulj28GO"
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "tags": [
    {
      "updatedAt": "2025-12-04T03:16:25.179Z",
      "createdAt": "2025-12-04T03:16:25.179Z",
      "id": "ZP7W67IQvc91HVCv",
      "name": "news"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-12-04T03:16:26.974Z",
  "versionId": "12839021-257b-435b-9f4d-82ca0263dfa9"
}